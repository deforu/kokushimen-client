# 🍓 Raspberry Pi 5用 kokushimen-client 簡単実行ガイド

このディレクトリには、Raspberry Pi 5で簡単にkokushimen-clientを実行するためのシェルスクリプトが含まれています。

## 📋 利用可能なスクリプト

### 🚀 **ワンライナー実行（超簡単）**
```bash
./quick_start.sh
```
セットアップ → モックサーバー起動 → クライアント実行を全自動で行います。

### 📦 **段階的実行（推奨）**

#### 1. セットアップ
```bash
./setup_raspi.sh
```
- システムパッケージのインストール
- Python仮想環境の作成
- 必要なPythonパッケージのインストール
- 設定ファイル（.env）の作成

#### 2. モックサーバー起動
```bash
./start_mock_server.sh
```
- テスト用のモックサーバーを起動
- WebSocket通信の動作確認用

#### 3. クライアント実行
```bash
./run_client.sh
```
- 対話式メニューでモード選択
- 自動的な設定読み込み
- サーバー接続確認

### ⚙️ **設定変更**
```bash
./config.sh
```
- 設定ファイル（.env）の編集
- サーバーIP、音声設定などの変更

## 🎯 **実行モード**

`./run_client.sh` では以下のモードを選択できます：

1. **疎通確認モード**: 音なし、トーン送信（初回確認用）
2. **デバイス確認モード**: 利用可能な音声デバイス一覧表示
3. **軽量モード**: ALSA入力 + sounddevice出力
4. **高機能モード**: sounddevice入出力
5. **カスタムモード**: .envファイルの設定を使用
6. **デバッグモード**: VADデバッグ出力有効

## 🔧 **初回セットアップ後の注意事項**

セットアップ完了後、audioグループの設定を反映するため再起動が必要です：
```bash
sudo reboot
```

## 📁 **生成されるファイル**

- `.env`: 設定ファイル
- `.venv/`: Python仮想環境
- `.env.backup`: 設定ファイルのバックアップ（リセット時）

## 🆘 **トラブルシューティング**

### 権限エラーの場合
```bash
sudo reboot  # audioグループ設定の反映
```

### パッケージエラーの場合
```bash
sudo apt update
sudo apt install -y python3-dev build-essential
```

### ポート使用中エラーの場合
```bash
sudo lsof -i :8000  # ポート使用状況確認
sudo pkill -f uvicorn  # uvicornプロセス停止
```

## 🎉 **動作確認**

正常に動作している場合：
1. クライアント起動時に接続メッセージが表示
2. 無音検出時に`stop`メッセージ送信
3. サーバーからビープ音受信・再生（音声出力有効時）

何か問題があれば、デバッグモード（モード6）で詳細なログを確認してください。

# 🔌 LED用抵抗器ガイド - なぜ必要？どう付ける？

## ⚡ なぜ抵抗器が必要なのか

### **LEDを壊さないため**
LEDは**電流制御素子**です。電圧を直接かけると、内部抵抗が非常に小さいため**過大な電流**が流れて即座に焼損します。

```
❌ 抵抗なし
GPIO (3.3V) ───→ LED ───→ GND
               ⚡ 過電流で破損！

✅ 抵抗あり
GPIO (3.3V) ───→ [抵抗] ───→ LED ───→ GND
                    ↓
                電流を制限
```

### **Raspberry Piのピンを保護するため**
- Raspberry Piの各GPIOピンは**最大16mA**まで
- ピン全体では**50mA**の上限あり
- 抵抗なしでLEDを接続すると、ピンが破損するリスクがあります

### **適切な明るさで点灯させるため**
- LEDには**定格電流**（通常15～20mA）があります
- この範囲内で点灯させることで、適切な明るさと寿命を確保できます

---

## 📐 抵抗値の計算方法

### **基本公式（オームの法則）**

```
R = (Vcc - Vf) / If

R  : 必要な抵抗値 (Ω)
Vcc: 電源電圧 (V) → Raspberry Piは3.3V
Vf : LEDの順方向電圧 (V)
If : LEDに流したい電流 (A)
```

### **RGB LEDの一般的な仕様**

| 色 | 順方向電圧 (Vf) | 推奨電流 (If) |
|----|----------------|--------------|
| 赤 | 1.8～2.2V | 15～20mA |
| 緑 | 3.0～3.3V | 15～20mA |
| 青 | 3.0～3.4V | 15～20mA |

### **計算例（Raspberry Pi 5での使用）**

#### **赤LED**
```
R = (3.3V - 2.0V) / 0.02A
R = 1.3V / 0.02A
R = 65Ω （理論値）
→ 実用的には 220Ω を推奨（安全マージン込み）
```

#### **緑LED**
```
R = (3.3V - 3.2V) / 0.02A
R = 0.1V / 0.02A
R = 5Ω （理論値）
→ 実用的には 100～220Ω を推奨
```

#### **青LED**
```
R = (3.3V - 3.2V) / 0.02A
R = 0.1V / 0.02A
R = 5Ω （理論値）
→ 実用的には 100～220Ω を推奨
```

### **推奨抵抗値まとめ**

| 目的 | 抵抗値 | 明るさ | 安全性 |
|------|--------|--------|--------|
| **標準** | **220Ω** | 適度 | ⭐⭐⭐ |
| 明るめ | 150Ω | 明るい | ⭐⭐ |
| 安全重視 | 330Ω | やや暗い | ⭐⭐⭐⭐ |
| 超安全 | 470Ω | 暗い | ⭐⭐⭐⭐⭐ |

💡 **初心者の方は 220Ω または 330Ω を使うのが最も安全です**

---

## 🔧 抵抗器の選び方

### **抵抗値の読み方（カラーコード）**

#### **220Ω（赤・赤・茶）**
```
┌─────────────┐
│ 🔴🔴🟤⚪️  │
│ 2  2  x10  │ = 22 x 10 = 220Ω
└─────────────┘
```

#### **330Ω（橙・橙・茶）**
```
┌─────────────┐
│ 🟠🟠🟤⚪️  │
│ 3  3  x10  │ = 33 x 10 = 330Ω
└─────────────┘
```

#### **470Ω（黄・紫・茶）**
```
┌─────────────┐
│ 🟡🟣🟤⚪️  │
│ 4  7  x10  │ = 47 x 10 = 470Ω
└─────────────┘
```

### **定格電力の選び方**

LEDに流す電流と電圧から消費電力を計算：

```
P = I × V
P = 0.02A × 1.3V (赤LEDの例)
P = 0.026W = 26mW
```

一般的な抵抗器：
- **1/8W (0.125W)**: 50mWまで → ギリギリ
- **1/4W (0.25W)**: 250mWまで → ✅ 推奨
- **1/2W (0.5W)**: 500mWまで → 余裕あり

💡 **1/4W (0.25W) の抵抗器を使うのが標準的です**

---

## 🛠️ 抵抗器の付け方（実践編）

### **方法1: 共通アノード型RGB LED**

```
配線順序:
GPIO 17 ──→ [220Ω] ──→ 赤LED端子
GPIO 27 ──→ [220Ω] ──→ 緑LED端子
GPIO 22 ──→ [220Ω] ──→ 青LED端子
           3.3V ──→ 共通アノード（長いピン）
```

#### **物理的な接続手順**

1. **抵抗器のリード線を曲げる**
   ```
   元の形: ───■───
           
   曲げる: ┐  ■  ┌
          └──■──┘
   ```

2. **ブレッドボードでの配線例**
   ```
   [Raspberry Pi]          [ブレッドボード]         [RGB LED]
   
   GPIO 17 ──────→ 行A ─ [220Ω] ─ 行B ───→ R (赤)
   GPIO 27 ──────→ 行C ─ [220Ω] ─ 行D ───→ G (緑)
   GPIO 22 ──────→ 行E ─ [220Ω] ─ 行F ───→ B (青)
   3.3V ──────────────────────────────────→ + (共通)
   ```

3. **直接配線する場合**
   ```
   ステップ1: GPIOピン → 抵抗の片側
   ステップ2: 抵抗のもう片側 → LEDの色端子
   ステップ3: LEDの共通端子 → 3.3V
   ```

### **方法2: 共通カソード型RGB LED**

```
配線順序:
GPIO 17 ──→ [220Ω] ──→ 赤LED端子
GPIO 27 ──→ [220Ω] ──→ 緑LED端子
GPIO 22 ──→ [220Ω] ──→ 青LED端子
           GND ──→ 共通カソード（長いピン）
```

💡 **配線は共通アノードと同じですが、共通端子をGNDに接続する点が異なります**

---

## 📷 実践例（写真での説明風）

### **必要な部品**
```
✅ RGB LED x1個
✅ 抵抗器 220Ω x3個（1/4W）
✅ ジャンパーワイヤー（オス-メス）x4本
✅ ブレッドボード（任意）
```

### **Step 1: 抵抗をLEDに接続**
```
   抵抗         LED
   ■───┐    ┌─赤
   ■   └────┤
            │
   ■───┐    ├─緑
   ■   └────┤
            │
   ■───┐    ├─青
   ■   └────┤
            │
            └─共通
```

### **Step 2: GPIOに接続**
```
Raspberry Pi 5のピン:
┌─────────────────┐
│ (1) 3.3V  ●  ○ │ ← 共通アノードの場合
│ (3)       ○  ○ │
│ (5)       ○  ● │ GND ← 共通カソードの場合
│ ...            │
│ (11) GPIO17 ● │ ← 赤LED
│ (13) GPIO27 ● │ ← 緑LED
│ (15) GPIO22 ● │ ← 青LED
└─────────────────┘
```

### **Step 3: 配線確認チェックリスト**

- [ ] 各色LEDに抵抗が1つずつ付いている
- [ ] 抵抗値は220Ω～330Ω
- [ ] GPIOピン番号が正しい（17, 27, 22）
- [ ] 共通端子が正しく接続されている
  - 共通アノード → 3.3V
  - 共通カソード → GND
- [ ] 配線がショートしていない

---

## ⚠️ よくある間違いと対処法

### **❌ 間違い1: 抵抗を付け忘れた**
**症状**: LEDが一瞬光って消える、GPIOピンが熱くなる  
**対処**: すぐに電源を切り、抵抗を追加する

### **❌ 間違い2: 抵抗値が小さすぎる**
**症状**: LEDが異常に明るい、熱くなる  
**対処**: より大きな抵抗値に変更（220Ω → 330Ω → 470Ω）

### **❌ 間違い3: 極性を逆にした**
**症状**: LEDが点灯しない  
**対処**: 共通アノードとカソードの接続を確認・修正

### **❌ 間違い4: 共通端子の配線ミス**
**症状**: すべての色が点灯しない  
**対処**: 
- 共通アノード → 3.3Vに接続されているか確認
- 共通カソード → GNDに接続されているか確認

---

## 🔍 トラブルシューティング

### **LEDが点灯しない場合**

1. **テスターで抵抗値を確認**
   ```bash
   # マルチメーターで抵抗を測定
   # 220Ω抵抗 → 200～250Ωの範囲ならOK
   ```

2. **配線の導通チェック**
   - ジャンパーワイヤーが断線していないか
   - 接触不良がないか

3. **GPIOピンの動作確認**
   ```python
   # test_led.pyを実行してGPIO出力を確認
   python test_led.py
   ```

### **LEDが暗い場合**

**原因**: 抵抗値が大きすぎる  
**解決策**: より小さな抵抗値に変更
- 330Ω → 220Ω
- 470Ω → 330Ω

### **LEDが明るすぎる/熱い場合**

**原因**: 抵抗値が小さすぎる  
**解決策**: より大きな抵抗値に変更
- 150Ω → 220Ω
- 220Ω → 330Ω

---

## 📚 参考情報

### **オームの法則を理解する**
```
V = I × R
I = V / R
R = V / I

V: 電圧 (Volt)
I: 電流 (Ampere)
R: 抵抗 (Ohm)
```

### **LEDの順方向電圧（Vf）の測り方**
データシートを確認するか、実測する：
```bash
# マルチメーターをダイオードモードにして測定
# 赤LED: 約1.8～2.2V
# 緑/青LED: 約3.0～3.4V
```

### **安全な実験方法**
1. 最初は大きめの抵抗値（470Ω）から始める
2. 徐々に小さくして明るさを調整（330Ω → 220Ω）
3. 常に電流を20mA以下に保つ

---

## ✅ クイックリファレンス

### **標準的な構成（Raspberry Pi 5 + RGB LED）**

```
部品リスト:
- RGB LED（共通アノード） x1
- 220Ω抵抗（1/4W） x3
- ジャンパーワイヤー x4

配線:
GPIO 17 → [220Ω] → 赤LED
GPIO 27 → [220Ω] → 緑LED
GPIO 22 → [220Ω] → 青LED
3.3V → 共通端子

設定:
USE_LED=1
LED_PIN_RED=17
LED_PIN_GREEN=27
LED_PIN_BLUE=22
LED_COMMON_ANODE=1
```

これで安全にLEDを光らせることができます！🎉
